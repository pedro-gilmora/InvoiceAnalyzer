@using EnterpriseAgent.Client.Models
@using Markdig
@using Microsoft.KernelMemory
@using Microsoft.SemanticKernel
@using Microsoft.SemanticKernel.ChatCompletion
@using Microsoft.SemanticKernel.TextGeneration
@using Microsoft.FluentUI.AspNetCore.Components.Icons.Regular

<FluentStack>
    <FluentPersona Image="@BotIcon" ImageSize="36px" Style="background-color: var(--info);" />
    <FluentLabel Style="background-color: var(--info); padding: 8px; border-radius: 8px; max-width: 45%;">
        @if (Agent.CurrentResponse.Length > 0)
        {
            @((MarkupString)Agent.CurrentResponse)
        }
        else
        {
            <FluentProgressRing Stroke="ProgressStroke.Small" style="width: 20px; height: 20px;" />
        }
    </FluentLabel>
</FluentStack>

@code {
    readonly static string
        BotIcon = new Size16.Bot().ToDataUri("18px", "white"),
        PersonaIcon = new Size16.Person().ToDataUri("18px", "white");

    [CascadingParameter]
    public required AgentService Agent { get; set; }

    protected override void OnInitialized() => Agent.RefreshCurrentMessage = StateHasChanged;
}
